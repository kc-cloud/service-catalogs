"use strict";(()=>{(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7248],{56420:(nt,L,t)=>{t.d(L,{Y:()=>Z});var a=t(95208),R=t(18139),O=t(54195),T=t(77125),m=t(64947),o=t(93453),S=t(29365),y=t(46423),G=t(5951),W=t(26343),F=t(28233),N=t(55197),l=t(58837),_=t(72501),n=t(5893),e=t(14041),c=t(45250),j=t.n(c),U=t(70209),J=t(92483),z=t(75202),dt=t(89475),V=t(10265);const k=(0,l.A)({popoverList:{minWidth:260,maxWidth:400},menuItem:{whiteSpace:"normal"}},{name:"BackstageSupportButton"}),w=({icon:h})=>{const B=(0,a.n)(),K=h?B.getSystemIcon(h)??J.NT:J.NT;return e.createElement(K,null)},Et=({link:h})=>e.createElement(z.N_,{to:h.url},h.title??h.url),it=({item:h})=>e.createElement(W.A,{button:!1},e.createElement(y.A,null,e.createElement(w,{icon:h.icon})),e.createElement(G.A,{primary:h.title,secondary:h.links?.reduce((B,K,X)=>[...B,X>0&&e.createElement("br",{key:X}),e.createElement(Et,{link:K,key:K.url})],[])}));function Z(h){const{t:B}=(0,V.i)(dt.O),{title:K,items:X,children:b}=h,{items:st}=(0,U.l)(),[Q,q]=(0,e.useState)(!1),[at,rt]=(0,e.useState)(null),tt=k(),lt=(0,R.gf)(O.U).getOptionalConfig("app.support"),ft=(0,n.A)(I=>I.breakpoints.down("sm")),ct=I=>{rt(I.currentTarget),q(!0)},P=()=>{q(!1)};return lt?e.createElement(e.Fragment,null,e.createElement(T.A,{display:"flex",ml:1},ft?e.createElement(S.A,{color:"primary",size:"small",onClick:ct,"data-testid":"support-button","aria-label":"Support"},e.createElement(J.NT,null)):e.createElement(m.A,{"data-testid":"support-button","aria-label":"Support",color:"primary",onClick:ct,startIcon:e.createElement(J.NT,null)},B("supportButton.title"))),e.createElement(N.Ay,{"data-testid":"support-button-popover",open:Q,anchorEl:at,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},onClose:P},e.createElement(F.A,{className:tt.popoverList,autoFocusItem:!!at},K&&e.createElement(W.A,{button:!1,alignItems:"flex-start",className:tt.menuItem},e.createElement(_.A,{variant:"subtitle1"},K)),e.Children.map(b,(I,C)=>e.createElement(W.A,{button:!1,alignItems:"flex-start",key:`child-${C}`,className:tt.menuItem},I)),(X??st).map((I,C)=>e.createElement(it,{item:I,key:`item-${C}`}))),e.createElement(o.A,null,e.createElement(m.A,{color:"primary",onClick:P,"aria-label":"Close"},B("supportButton.close"))))):null}},77509:(nt,L,t)=>{t.d(L,{GI:()=>_});var a=t(14041),R=t(77125),O=t(64947),T=t(73845),m=t(42899),o=t(72501),S=t(5893),y=t(54917),G=t(65859),W=t(80084),F=t(10265);const N=n=>{const e=(0,S.A)(z=>z.breakpoints.down(n.options?.drawerBreakpoint??"md")),c=(0,y.A)(),[j,U]=(0,a.useState)(!1),{t:J}=(0,F.i)(W.j);return e?a.createElement(a.Fragment,null,a.createElement(O.A,{style:{marginTop:c.spacing(1),marginLeft:c.spacing(1)},onClick:()=>U(!0),startIcon:a.createElement(G.A,null)},J("catalogFilter.buttonTitle")),a.createElement(T.Ay,{open:j,onClose:()=>U(!1),anchor:n.options?.drawerAnchor??"left",disableAutoFocus:!0,keepMounted:!0,variant:"temporary"},a.createElement(R.A,{m:2},a.createElement(o.A,{variant:"h6",component:"h2",style:{marginBottom:c.spacing(1)}},J("catalogFilter.title")),n.children))):a.createElement(m.A,{item:!0,lg:2},n.children)},l=n=>a.createElement(m.A,{item:!0,xs:12,lg:10},n.children),_=n=>a.createElement(m.A,{container:!0,style:{position:"relative"}},n.children);_.Filters=N,_.Content=l},24999:(nt,L,t)=>{t.d(L,{y:()=>it});var a=t(77125),R=t(72501),O=t(58837),T=t(6924),m=t(61783),o=t(14041),S=t(18139),y=t(73466),G=t(30043),W=t(69076),F=t(86901),N=t(44148),l=t(41260);const _=o.createElement(l.A,{fontSize:"small"}),n=o.createElement(N.A,{fontSize:"small"});function e({selected:Z}){return o.createElement(W.A,{icon:_,checkedIcon:n,checked:Z})}const c=(0,o.memo)(Z=>{const{selected:h,value:B,availableOptions:K,showCounts:X}=Z,b=X?`${B} (${K?.[B]})`:B;return o.createElement(F.A,{control:o.createElement(e,{selected:h}),label:b,onClick:st=>st.preventDefault()})});var j=t(16249),U=t(99703),J=t(53373),z=t.n(J);const dt=(0,O.A)(Z=>(0,U.A)({input:{backgroundColor:Z.palette.background.paper}}),{name:"CatalogReactEntityAutocompletePickerInput"});function V(Z){const h=dt();return o.createElement(j.A,{variant:"outlined",...Z,className:z()(h.input,Z.className)})}var k=t(18453),w=t(15998);const Et=(0,O.A)({root:{},label:{textTransform:"none",fontWeight:"bold"}},{name:"CatalogReactEntityAutocompletePicker"});function it(Z){const{label:h,name:B,path:K,showCounts:X,Filter:b,InputProps:st,initialSelectedOptions:Q=[],filtersForAvailableValues:q=["kind"]}=Z,at=Et(),{updateFilters:rt,filters:tt,queryParameters:{[B]:lt}}=(0,k.nK)(),ft=(0,S.gf)(G.v),ct=q.map(s=>tt[s]),{value:P}=(0,y.A)(async()=>{const s=K,{facets:i}=await ft.getEntityFacets({facets:[s],filter:(0,w.Rr)(ct.filter(Boolean))});return Object.fromEntries(i[s].map(({value:u,count:A})=>[u,A]))},[...ct]),I=(0,o.useMemo)(()=>[lt].flat().filter(Boolean),[lt]),[C,r]=(0,o.useState)(I.length?I:tt[B]?.values??Q);(0,o.useEffect)(()=>{I.length&&r(I)},[I]);const f=Object.keys(P??{}),d=C.length&&f.length;(0,o.useEffect)(()=>{rt({[B]:d?new b(C):void 0})},[B,d,C,b,rt]);const v=tt[B];return v&&typeof v=="object"&&!("values"in v)||!f.length?null:o.createElement(a.A,{className:at.root,pb:1,pt:1},o.createElement(R.A,{className:at.label,variant:"button",component:"label"},h,o.createElement(m.Ay,{PopperComponent:s=>o.createElement("div",{...s},s.children),multiple:!0,disableCloseOnSelect:!0,options:f,value:C,onChange:(s,i)=>r(i),renderOption:(s,{selected:i})=>o.createElement(c,{selected:i,value:s,availableOptions:P,showCounts:!!X}),size:"small",popupIcon:o.createElement(T.A,{"data-testid":`${String(B)}-picker-expand`}),renderInput:s=>o.createElement(V,{...s,...st})})))}},40941:(nt,L,t)=>{t.d(L,{t:()=>v});var a=t(78560),R=t(77125),O=t(69076),T=t(86901),m=t(16249),o=t(72501),S=t(71677),y=t(58837),G=t(99703),W=t(7031),F=t(44148),N=t(41260),l=t(6924),_=t(61783),n=t(14041),e=t(18453),c=t(49724),j=t(16261);function U(s){const i=(0,j.J)(s);(0,n.useEffect)(()=>()=>{i.current()},[])}function J(s,i,u,A=0){const g=(0,n.useRef)(),E=(0,n.useRef)(),p=(0,n.useRef)(s),M=(0,n.useRef)(),Y=()=>{g.current&&(clearTimeout(g.current),g.current=void 0),E.current&&(clearTimeout(E.current),E.current=void 0)};return U(Y),(0,n.useEffect)(()=>{p.current=s},i),(0,n.useMemo)(()=>{const x=()=>{if(Y(),!M.current)return;const et=M.current;M.current=void 0,p.current.apply(et.this,et.args)},H=function(...et){g.current&&clearTimeout(g.current),M.current={args:et,this:this},g.current=setTimeout(x,u),A>0&&!E.current&&(E.current=setTimeout(x,A))};return Object.defineProperties(H,{length:{value:s.length},name:{value:`${s.name||"anonymous"}__debounced__${u}`}}),H},[u,A,...i])}function z(s,i,u,A=0){(0,n.useEffect)(J(s,i,u,A),i)}var dt=t(48108),V=t(47966),k=t(53318),w=t(18139),Et=t(87290),it=t(30043),Z=t(46123),h=t.n(Z);const B=s=>typeof s=="string"?s:void 0;function K({enabled:s}){const i=(0,w.gf)(it.v),[u]=(0,n.useState)(async()=>{if(!s)return[];const A="relations.ownedBy",E=(await i.getEntityFacets({facets:[A]})).facets[A]?.map(p=>p.value)??[];return i.getEntitiesByRefs({entityRefs:E}).then(p=>p.items.filter(M=>M!==void 0).map(M=>M).sort((M,Y)=>(M.metadata.namespace||"").localeCompare(Y.metadata.namespace||"","en-US")||(B(h()(M,"spec.profile.displayName"))||M.metadata.title||M.metadata.name).localeCompare(B(h()(Y,"spec.profile.displayName"))||Y.metadata.title||Y.metadata.name,"en-US")||M.kind.localeCompare(Y.kind,"en-US"))).then(p=>p).catch(()=>[])});return(0,Et.A)(async(A,g)=>{const E=await u;if(!E)return{items:[]};const p=g?.limit??20,{text:M,start:Y}=X(A),x=E.filter(et=>Q(M,et)),H=Y+p;return{items:x.slice(0,H),...st({entities:x,limit:H,payload:{text:M,start:H}})}},[u],{loading:!0,value:{items:[]}})}function X(s){return b(s)&&s.cursor?JSON.parse(atob(s.cursor)):{text:s.text||"",start:0}}function b(s){return!!s.cursor}function st({entities:s,limit:i,payload:u}){return s.length>i?{cursor:btoa(JSON.stringify(u))}:{}}function Q(s,i){const u=s.trim();return i.kind.includes(u)||i.metadata.namespace?.includes(u)||i.metadata.name.includes(u)||i.metadata.title?.includes(u)||h()(i,"spec.profile.displayName")?.includes(u)}function q(){const s=(0,w.gf)(it.v);return(0,Et.A)(async(i,u)=>{const A=i,g=i,E=u?.limit??20;if(g.cursor){const M=await s.queryEntities({cursor:g.cursor,limit:E});return{cursor:M.pageInfo.nextCursor,items:[...g.items,...M.items]}}const p=await s.queryEntities({fullTextFilter:{term:A.text||"",fields:["metadata.name","kind","spec.profile.displayname","metadata.title"]},filter:{kind:["User","Group"]},orderFields:[{field:"metadata.name",order:"asc"}],limit:E});return{cursor:p.pageInfo.nextCursor,items:p.items}},[],{loading:!0})}var at=t(76842);function rt({mode:s,initialSelectedOwnersRefs:i}){const u=s==="owners-only",A=q(),g=K({enabled:u}),[E,p]=u?g:A;return[E,p,tt({enabled:!u,initialSelectedOwnersRefs:i})]}function tt({enabled:s,initialSelectedOwnersRefs:i}){const u=(0,n.useRef)({}),A=(0,w.gf)(it.v),[,g]=(0,Et.A)(async()=>{(await A.getEntitiesByRefs({entityRefs:i})).items.forEach(p=>{p&&(u.current[(0,a.U2)(p)]=p)})},[]);return(0,at.u)(()=>{s&&i.length>0&&g()}),{getEntity:E=>u.current[E],setEntity:E=>{u.current[(0,a.U2)(E)]=E}}}var lt=t(46509),ft=t(96403),ct=t(80084),P=t(10265);const I=(0,y.A)(s=>(0,G.A)({root:{},label:{textTransform:"none",fontWeight:"bold"},input:{backgroundColor:s.palette.background.paper},fullWidth:{width:"100%"},boxLabel:{width:"100%",textOverflow:"ellipsis",overflow:"hidden"}}),{name:"CatalogReactEntityOwnerPicker"}),C=(0,W.A)(s=>({label:{width:"100%"},root:{width:"90%"}}),{name:"FixedWidthFormControlLabel"})(T.A),r=n.createElement(N.A,{fontSize:"small"}),f=n.createElement(F.A,{fontSize:"small"});function d(s){const i=I(),u=s.entity.kind.toLocaleLowerCase("en-US")==="group",{primaryTitle:A}=(0,lt.f)(s.entity);return n.createElement(R.A,{className:i.fullWidth},n.createElement(C,{className:i.fullWidth,control:n.createElement(O.A,{icon:r,checkedIcon:f,checked:s.isSelected}),onClick:g=>g.preventDefault(),label:n.createElement(S.Ay,{title:A},n.createElement(R.A,{display:"flex",alignItems:"center"},u?n.createElement(V.A,{fontSize:"small"}):n.createElement(dt.A,{fontSize:"small"}),"\xA0",n.createElement(R.A,{className:i.boxLabel},n.createElement(o.A,{noWrap:!0},A))))}))}const v=s=>{const i=I(),{mode:u="owners-only"}=s||{},{updateFilters:A,filters:g,queryParameters:{owners:E}}=(0,e.nK)(),[p,M]=(0,n.useState)(""),{t:Y}=(0,P.i)(ct.j),x=(0,n.useMemo)(()=>[E].flat().filter(Boolean),[E]),[H,et]=(0,n.useState)(x.length?x:g.owners?.values??[]),[{value:vt,loading:gt},pt,At]=rt({mode:u,initialSelectedOwnersRefs:H});z(()=>pt({text:p}),[p,pt],250);const yt=vt?.items||[];return(0,n.useEffect)(()=>{if(x.length){const D=new c.N9(x);et(D.values)}},[x]),(0,n.useEffect)(()=>{A({owners:H.length?new c.N9(H):void 0})},[H,A]),["user","group"].includes(g.kind?.value.toLocaleLowerCase("en-US")||"")?null:n.createElement(R.A,{className:i.root,pb:1,pt:1},n.createElement(o.A,{className:i.label,variant:"button",component:"label"},Y("entityOwnerPicker.title"),n.createElement(_.Ay,{PopperComponent:D=>n.createElement("div",{...D},D.children),multiple:!0,disableCloseOnSelect:!0,loading:gt,options:yt,value:H,getOptionSelected:(D,$)=>typeof $=="string"?(0,a.U2)(D)===$:D===$,getOptionLabel:D=>{const $=typeof D=="string"?At.getEntity(D)||(0,a.KU)(D,{defaultKind:"group",defaultNamespace:"default"}):D;return(0,k.Z)($,(0,k.S)($))},onChange:(D,$)=>{M(""),et($.map(ut=>{const ht=typeof ut=="string"?ut:(0,a.U2)(ut);return typeof ut!="string"&&At.setEntity(ut),ht}))},filterOptions:D=>D,renderOption:(D,{selected:$})=>n.createElement(d,{entity:D,isSelected:$}),size:"small",popupIcon:n.createElement(l.A,{"data-testid":"owner-picker-expand"}),renderInput:D=>n.createElement(m.A,{...D,className:i.input,onChange:$=>{M($.currentTarget.value)},variant:"outlined"}),ListboxProps:{onScroll:D=>{const $=D.currentTarget;Math.abs($.scrollHeight-$.clientHeight-$.scrollTop)<1&&vt?.cursor&&pt({items:vt.items,cursor:vt.cursor})},"data-testid":"owner-picker-listbox"}})))}},56829:(nt,L,t)=>{t.d(L,{m:()=>y});var a=t(58837),R=t(14041),O=t(49724),T=t(24999),m=t(80084),o=t(10265);const S=(0,a.A)({input:{}},{name:"CatalogReactEntityTagPicker"}),y=G=>{const W=S(),{t:F}=(0,o.i)(m.j);return R.createElement(T.y,{label:F("entityTagPicker.title"),name:"tags",path:"metadata.tags",Filter:O.q_,showCounts:G.showCounts,InputProps:{className:W.input}})}},30117:(nt,L,t)=>{t.d(L,{y:()=>C});var a=t(18139),R=t(54195),O=t(40703),T=t(58007),m=t(46423),o=t(65569),S=t(5951),y=t(26343),G=t(72501),W=t(58837),F=t(9684),N=t(92483),l=t(14041),_=t(49724),n=t(18453),e=t(46343),c=t(40074),j=t(46123),U=t(96403),J=t(94223),z=t(45250),dt=t(73466),V=t(30043),k=t(15998),w=t(87290),Et=function(r){return r!==Object(r)},it=function(r,f,d){var v=(0,l.useRef)(void 0);(!v.current||!d(f,v.current))&&(v.current=f),(0,l.useEffect)(r,v.current)};const Z=it;var h=t(56307),B=t.n(h);const K=B();var X=function(r){return r!==Object(r)},b=function(r,f){Z(r,f,K)};const st=b;function Q(){const r=(0,a.gf)(J.K),f=(0,a.gf)(V.v),{filters:d}=(0,n.nK)(),{value:v,loading:s}=(0,dt.A)(async()=>(await r.getBackstageIdentity()).ownershipEntityRefs,[]),{user:i,owners:u,...A}=d,g=(0,k.$3)((0,z.compact)(Object.values(A))),[{value:E,loading:p},M]=(0,w.A)(async x=>{const H=q(x.owners,x.ownershipEntityRefs);if(H===void 0)return 0;const{["metadata.name"]:et,...vt}=x.filter.filter,{totalItems:gt}=await f.queryEntities({...x.filter,filter:{...vt,"relations.ownedBy":H},limit:0});return gt},[],{loading:!0});return st(()=>{Object.keys(g.filter).length!==0&&v!==void 0&&M({ownershipEntityRefs:v,owners:u,filter:g})},[v,u,g]),{count:E,loading:s||p,filter:(0,l.useMemo)(()=>_.tN.owned(v??[]),[v]),ownershipEntityRefs:v}}function q(r,f){if(f===void 0)return;const d=r?.values??[];if(d.length){const v=(0,z.intersection)(d,f);return v.length===0?void 0:v}return f}function at(){const r=(0,a.gf)(V.v),{filters:f}=(0,n.nK)(),d=(0,l.useRef)(),v=(0,l.useMemo)(()=>{const{user:u,...A}=f,g=(0,z.compact)(Object.values(A)),E=(0,k.$3)(g),p={...E,limit:0};return Object.keys(E.filter).length===0?(d.current=void 0,d.current):(0,z.isEqual)(p,d.current)?d.current:(d.current=p,p)},[f]),{value:s,loading:i}=(0,dt.A)(async()=>{if(v===void 0)return 0;const{totalItems:u}=await r.queryEntities(v);return u},[v]);return{count:s,loading:i}}var rt=t(78560),tt=t(44861);function lt(){const r=(0,a.gf)(V.v),{filters:f}=(0,n.nK)(),{starredEntities:d}=(0,tt.I)(),v=(0,l.useRef)(),s=(0,l.useMemo)(()=>{const{user:g,...E}=f,p=(0,z.compact)(Object.values(E)),M=(0,k.$3)(p),x={...M,filter:{...M.filter,["metadata.name"]:Array.from(d).map(H=>(0,rt.KU)(H).name)},limit:1e3};return(0,z.isEqual)(x,v.current)?v.current:(v.current=x,x)},[f,d]),{value:i,loading:u}=(0,dt.A)(async()=>d.size?(await r.queryEntities(s)).items.map(E=>(0,rt.U2)({kind:E.kind,namespace:E.metadata.namespace,name:E.metadata.name})).filter(E=>d.has(E)).length:0,[s,d]),A=(0,l.useMemo)(()=>_.tN.starred(Array.from(d)),[d]);return{count:i,loading:u,filter:A}}var ft=t(10265),ct=t(80084);const P=(0,W.A)(r=>({root:{backgroundColor:"rgba(0, 0, 0, .11)",boxShadow:"none",margin:r.spacing(1,0,1,0)},title:{margin:r.spacing(1,0,0,1),textTransform:"uppercase",fontSize:12,fontWeight:"bold"},listIcon:{minWidth:30,color:r.palette.text.primary},menuItem:{minHeight:r.spacing(6)},groupWrapper:{margin:r.spacing(1,1,2,1)}}),{name:"CatalogReactUserListPicker"});function I(r,f){return[{name:f("userListPicker.personalFilter.title"),items:[{id:"owned",label:f("userListPicker.personalFilter.ownedLabel"),icon:F.A},{id:"starred",label:f("userListPicker.personalFilter.starredLabel"),icon:N.Gg}]},{name:r,items:[{id:"all",label:f("userListPicker.orgFilterAllLabel")}]}]}const C=r=>{const{initialFilter:f,availableFilters:d}=r,v=P(),s=(0,a.gf)(R.U),{t:i}=(0,ft.i)(ct.j),u=s.getOptionalString("organization.name")??i("userListPicker.defaultOrgName"),{filters:A,updateFilters:g,queryParameters:{kind:E,user:p}}=(0,n.nK)(),M=["starred","all"],Y=I(u,i).map(mt=>({...mt,items:mt.items.filter(({id:ot})=>["group","user"].some(Ot=>Ot===E)?M.includes(ot):!d||d.includes(ot))})).filter(({items:mt})=>!!mt.length),{count:x,loading:H,filter:et}=Q(),{count:vt}=at(),{count:gt,filter:pt,loading:At}=lt(),yt=(0,l.useMemo)(()=>[p].flat()[0],[p]),[D,$]=(0,l.useState)(yt??f),ut=(0,l.useMemo)(()=>({all:vt,starred:gt,owned:x}),[gt,x,vt]);(0,l.useEffect)(()=>{yt&&$(yt)},[yt]);const ht=H||At;return(0,l.useEffect)(()=>{!ht&&D&&D!=="all"&&ut[D]===0&&$("all")},[ht,ut,D,$]),(0,l.useEffect)(()=>{if(!D||ht)return;g({user:D==="owned"?et:D==="starred"?pt:_.tN.all()})},[D,pt,et,g,ht]),l.createElement(O.A,{className:v.root},Y.map(mt=>l.createElement(l.Fragment,{key:mt.name},l.createElement(G.A,{variant:"subtitle2",component:"span",className:v.title},mt.name),l.createElement(O.A,{className:v.groupWrapper},l.createElement(T.A,{disablePadding:!0,dense:!0,role:"menu","aria-label":mt.name},mt.items.map((ot,Ot)=>l.createElement(y.A,{role:"none presentation",key:ot.id,divider:Ot!==mt.items.length-1,onClick:()=>$(ot.id),selected:ot.id===A.user?.value,className:v.menuItem,disabled:ut[ot.id]===0,"data-testid":`user-picker-${ot.id}`,tabIndex:0,ContainerProps:{role:"menuitem"}},ot.icon&&l.createElement(m.A,{className:v.listIcon},l.createElement(ot.icon,{fontSize:"small"})),l.createElement(S.A,null,l.createElement(G.A,{variant:"body1"},ot.label," ")),l.createElement(o.A,null,ut[ot.id]??"-"))))))))}},49724:(nt,L,t)=>{t.d(L,{I5:()=>G,Kf:()=>l,N9:()=>y,V3:()=>S,gM:()=>T,gZ:()=>N,mT:()=>_,qA:()=>m,q_:()=>o,tN:()=>F,z:()=>W});var a=t(78560),R=t(97214),O=t(699);class T{constructor(e){this.value=e}getCatalogFilters(){return{kind:this.value}}toQueryValue(){return this.value}}class m{constructor(e){this.value=e}getTypes(){return Array.isArray(this.value)?this.value:[this.value]}getCatalogFilters(){return{"spec.type":this.getTypes()}}toQueryValue(){return this.getTypes()}}class o{constructor(e){this.values=e}filterEntity(e){return this.values.every(c=>(e.metadata.tags??[]).includes(c))}getCatalogFilters(){return{"metadata.tags":this.values}}toQueryValue(){return this.values}}class S{constructor(e){this.value=e}filterEntity(e){const c=this.toUpperArray(this.value.split(/\s/)),j=this.toUpperArray([e.metadata.tags]),U=this.toUpperArray([e.metadata.name,e.metadata.title]);for(const J of c)if(j.every(z=>z!==J)&&U.every(z=>!z.includes(J)))return!1;return!0}getFullTextFilters(){return{term:this.value,fields:["metadata.name","metadata.title","spec.profile.displayName"]}}toQueryValue(){return this.value}toUpperArray(e){return e.flat().filter(c=>!!c).map(c=>c.toLocaleUpperCase("en-US"))}}class y{values;constructor(e){this.values=e.reduce((c,j)=>{try{return c.push((0,a.U2)((0,a.KU)(j,{defaultKind:"Group"}))),c}catch{return c}},[])}getCatalogFilters(){return{"relations.ownedBy":this.values}}filterEntity(e){return this.values.some(c=>(0,O.t)(e,R.vv).some(j=>(0,a.U2)(j)===c))}toQueryValue(){return this.values}}class G{constructor(e){this.values=e}getCatalogFilters(){return{"spec.lifecycle":this.values}}filterEntity(e){return this.values.some(c=>e.spec?.lifecycle===c)}toQueryValue(){return this.values}}class W{constructor(e){this.values=e}getCatalogFilters(){return{"metadata.namespace":this.values}}filterEntity(e){return this.values.some(c=>e.metadata.namespace===c)}toQueryValue(){return this.values}}class F{constructor(e,c){this.value=e,this.refs=c}static owned(e){return new F("owned",e)}static all(){return new F("all")}static starred(e){return new F("starred",e)}getCatalogFilters(){return this.value==="owned"?{"relations.ownedBy":this.refs??[]}:this.value==="starred"?{"metadata.name":this.refs?.map(e=>(0,a.KU)(e).name)??[]}:{}}filterEntity(e){if(this.value==="starred")return this.refs?.includes((0,a.U2)(e))??!0;if(this.value==="owned"){const c=(0,O.t)(e,R.vv);return this.refs?.some(j=>c.some(U=>(0,a.U2)(U)===j))??!1}return!0}toQueryValue(){return this.value}}class N{constructor(e,c,j){this.value=e,this.isOwnedEntity=c,this.isStarredEntity=j}filterEntity(e){switch(this.value){case"owned":return this.isOwnedEntity(e);case"starred":return this.isStarredEntity(e);default:return!0}}toQueryValue(){return this.value}}class l{constructor(e){this.value=e}getCatalogFilters(){return this.value?{"metadata.annotations.backstage.io/orphan":String(this.value)}:{}}filterEntity(e){const c=e.metadata.annotations?.["backstage.io/orphan"];return c!==void 0&&this.value.toString()===c}}class _{constructor(e){this.value=e}filterEntity(e){const c=e?.status?.items?.length>0;return c!==void 0&&this.value===c}}},18453:(nt,L,t)=>{t.d(L,{B9:()=>_,nK:()=>n});var a=t(45250),R=t.n(a),O=t(45810),T=t.n(O),m=t(14041),o=t(18690),S=t(87290),y=t(22771),G=t(71581),W=t(30043),F=t(15998),N=t(18139);const l=(0,m.createContext)(void 0),_=e=>{const c=(0,G.A)(),j=(0,N.gf)(W.v),[U,J]=(0,m.useState)({}),z=(0,o.zy)(),V=e.pagination===!0?"cursor":typeof e.pagination=="object"?e.pagination.mode??"cursor":"none",k=typeof e.pagination=="object"?e.pagination.limit??20:20,{queryParameters:w,cursor:Et,offset:it,limit:Z}=(0,m.useMemo)(()=>{const P=T().parse(z.search,{ignoreQueryPrefix:!0});let I=k;if(typeof P.limit=="string"){const r=Number.parseInt(P.limit,10);isNaN(r)||(I=r)}const C=typeof P.offset=="string"&&V==="offset"?Number.parseInt(P.offset,10):void 0;return{queryParameters:P.filters??{},cursor:typeof P.cursor=="string"&&V==="cursor"?P.cursor:void 0,offset:V==="offset"&&C&&!isNaN(C)?C:void 0,limit:I}},[V,z.search,k]),[h,B]=(0,m.useState)(Et),[K,X]=(0,m.useState)(it),[b,st]=(0,m.useState)(Z),[Q,q]=(0,m.useState)(()=>({appliedFilters:{},entities:[],backendEntities:[],pageInfo:V==="cursor"?{}:void 0,offset:K,limit:b})),[{loading:at,error:rt},tt]=(0,S.A)(async()=>{const P=(0,a.compact)(Object.values(U)),I=Object.keys(U).reduce((C,r)=>{const f=U[r];return f?.toQueryValue&&(C[r]=f.toQueryValue()),C},{});if(V!=="none")if(h){if(h!==Q.appliedCursor){const C=(0,F.be)(P),r=await j.queryEntities({cursor:h,limit:b});q({appliedFilters:U,appliedCursor:h,backendEntities:r.items,entities:r.items.filter(C),pageInfo:r.pageInfo,totalItems:r.totalItems})}}else{const C=(0,F.be)(P),r=(0,F.$3)(P),f=(0,F.$3)((0,a.compact)(Object.values(Q.appliedFilters)));if(V==="offset"||!(0,a.isEqual)(f,r)){const d=await j.queryEntities({...r,limit:b,offset:K,orderFields:[{field:"metadata.name",order:"asc"}]});q({appliedFilters:U,backendEntities:d.items,entities:d.items.filter(C),pageInfo:d.pageInfo,totalItems:d.totalItems,limit:b,offset:K})}}else{const C=(0,F.be)(P),r=(0,F.Rr)(P),f=(0,F.Rr)((0,a.compact)(Object.values(Q.appliedFilters)));if((0,a.isEqual)(f,r)){const d=Q.backendEntities.filter(C);q({appliedFilters:U,backendEntities:Q.backendEntities,entities:d,totalItems:d.length})}else{const d=await j.getEntities({filter:r}),v=d.items.filter(C);q({appliedFilters:U,backendEntities:d.items,entities:v,totalItems:v.length})}}if(c()){const C=T().parse(z.search,{ignoreQueryPrefix:!0}),r=T().stringify({...C,filters:I,cursor:h,offset:K,limit:b},{addQueryPrefix:!0,arrayFormat:"repeat"}),f=`${window.location.pathname}${r}`;window.history?.replaceState(null,document.title,f)}},[j,w,U,Q,h,V,b,K],{loading:!0});(0,y.A)(tt,10,[U,h,b,K]);const lt=(0,m.useCallback)(P=>{B(void 0),J(I=>{const C=typeof P=="function"?P(I):P;return{...I,...C}})},[]),ft=(0,m.useMemo)(()=>{if(V!=="cursor")return;const P=Q.pageInfo?.prevCursor,I=Q.pageInfo?.nextCursor;return{prev:P?()=>B(P):void 0,next:I?()=>B(I):void 0}},[V,Q.pageInfo]),ct=(0,m.useMemo)(()=>({filters:Q.appliedFilters,entities:Q.entities,backendEntities:Q.backendEntities,updateFilters:lt,queryParameters:w,loading:at,error:rt,pageInfo:ft,totalItems:Q.totalItems,limit:b,offset:K,setLimit:st,setOffset:X,paginationMode:V}),[Q,lt,w,at,rt,ft,b,K,V,st,X]);return m.createElement(l.Provider,{value:ct},e.children)};function n(){const e=(0,m.useContext)(l);if(!e)throw new Error("useEntityList must be used within EntityListProvider");return e}},44861:(nt,L,t)=>{t.d(L,{I:()=>F});var a=t(78560),R=t(18139),O=t(14041),T=t(11746),m=t(46123),o=t.n(m),S=t(9974),y=t(96403),G=t.n(y);function W(N){return typeof N=="string"?N:(0,a.U2)(N)}function F(){const N=(0,R.gf)(S.a),l=(0,T.A)((0,O.useMemo)(()=>N.starredEntitie$(),[N]),new Set),_=(0,O.useCallback)(e=>l.has(W(e)),[l]),n=(0,O.useCallback)(e=>N.toggleStarred(W(e)).then(),[N]);return{starredEntities:l,toggleStarredEntity:n,isStarredEntity:_}}},15998:(nt,L,t)=>{t.d(L,{$3:()=>O,Rr:()=>T,be:()=>m});var a=t(49724);function R(o){return!!o.getFullTextFilters}function O(o){const S=o.reduce((G,W)=>({...G,...W.getCatalogFilters?W.getCatalogFilters():{}}),{}),y=o.find(R)?.getFullTextFilters();return{filter:S,fullTextFilter:y}}function T(o){const S={};return o.forEach(y=>{y instanceof a.q_||y instanceof a.N9||y instanceof a.I5||y instanceof a.z||y instanceof a.tN||y instanceof a.Kf||y instanceof a.V3||y instanceof a.gZ||Object.assign(S,y.getCatalogFilters?.()||{})}),S}function m(o){return S=>o.every(y=>!y.filterEntity||y.filterEntity(S))}},44148:(nt,L,t)=>{var a,R=t(4293),O=t(78920);a={value:!0},L.A=void 0;var T=O(t(14041)),m=R(t(74044)),o=(0,m.default)(T.createElement("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox");L.A=o},41260:(nt,L,t)=>{var a,R=t(4293),O=t(78920);a={value:!0},L.A=void 0;var T=O(t(14041)),m=R(t(74044)),o=(0,m.default)(T.createElement("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank");L.A=o},47966:(nt,L,t)=>{var a,R=t(4293),O=t(78920);a={value:!0},L.A=void 0;var T=O(t(14041)),m=R(t(74044)),o=(0,m.default)(T.createElement("path",{d:"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"}),"Group");L.A=o}}]);})();

//# sourceMappingURL=7248.8756cbec.chunk.js.map